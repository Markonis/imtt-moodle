{
    "spec_version":1,
    "pipeline_version":1,
    "name":"Sinhronizacija assignment-a sa Google Sheets",
    "description":"Kada student uradi submit za odredjeni assignment, u izabrani Google Sheets fajl se u zadatoj koloni za tog studenta upise zadata vrednost.",
    "author":"Marko Pavlovic",
    "license":"GPL-3.0",
    "trigger":{
        "type":"moodle_event",
        "event_name":"\\some\\moodle\\event"
    },
    "params":[
        {
            "id":"moodle_assignment_id",
            "type":"text",
            "label":"Izaberite zadatak"
        },
        {
            "id":"google_sheet_id",
            "type":"text",
            "label":"Izaberite Google Sheets dokument"
        },
        {
            "id":"google_sheet_key_column",
            "type":"text",
            "label":"Unesite kolonu koja sadrzi indeks studenta"
        },
        {
            "id":"google_sheet_value_column",
            "type":"text",
            "label":"Unesite kolonu u koju ce se upisati vrednost"
        },
        {
            "id":"google_sheet_value",
            "type":"text",
            "label":"Unesite vrednost koju treba upisati"
        }
    ],
    "processors":[
        {
            "type":"filter",
            "condition":{
                "type":"equal",
                "op1":{
                    "type":"data",
                    "source":"params.moodle_assignment_id"
                },
                "op2":{
                    "type":"data",
                    "source":"trigger.objectid"
                }
            }
        },
        {
            "type":"middleman_request",
            "path":"/api/google/sheets/update",
            "params":{
                "token": {
                    "source":"imtt.provider_access_token",
                },
                "sheet_id":{
                    "source":"params.google_sheet_id"
                },
                "key_column":{
                    "source":"params.google_sheet_key_column"
                },
                "value_column":{
                    "source":"params.google_sheet_value_column"
                },
                "value":{
                    "source":"params.google_sheet_value"
                }
            }
        }
    ]
}
